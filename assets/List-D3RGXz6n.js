import{r,u as F,i as S,c as a,a as t,t as i,d as R,e as K,w as C,v as D,j as p,n as N,F as V,k as $,b as m,S as y,f as k,g as W,o as l,h as G,l as A}from"./index-BRRFBOoj.js";const M={id:"todoListPage",class:"bg-half"},j={class:"todo_sm"},q={href:"/vue_todolist/#/todolist"},H={class:"conatiner todoListPage vhContainer"},X={class:"todoList_Content"},Y={class:"inputBox"},J={key:0,class:"todoList_list"},Z={class:"todoList_tab"},tt={key:0,class:"todoList_items"},et={class:"todoList_item"},st=["for"],ot=["id","onUpdate:modelValue"],at=["onClick"],lt={key:0,class:"todoList_statistics"},nt={key:1,class:"todoList_items"},it={class:"todoList_item"},rt=["for"],ut=["id","onUpdate:modelValue"],dt=["onClick"],ct={key:0,class:"todoList_statistics"},vt={key:2,class:"todoList_items"},pt={class:"todoList_item"},ht=["for"],_t=["id","onUpdate:modelValue"],mt=["onClick"],ft={key:0,class:"todoList_statistics"},kt={key:1,style:{"text-align":"center"}},gt="https://todolist-api.hexschool.io",b="http://localhost:3000",Lt={__name:"List",setup(Ct){const u=r(""),L=r(""),O=F(),x=r("");(async()=>{u.value=document.cookie.replace(/(?:(?:^|.*;\s*)userToken\s*\=\s*([^;]*).*$)|^.*$/,"$1"),u.value||(y.fire({position:"top",title:"請登入",icon:"error",timer:1e3,toast:!0,showConfirmButton:!1,timerProgressBar:!0}),O.push({path:"/"}));try{const o=await k.get(`${b}/users/checkout`,{headers:{Authorization:u.value}});console.log("res.data:",o.data),x.value=o.data,g()}catch(o){console.log(o)}})();const Q=r(""),E=async()=>{await k.post(`${b}/users/sign_out`,{headers:{Authorization:u.value}}),document.cookie="userToken=",Q.value="已登出",y.fire({position:"top",title:`${Q.value}`,icon:"success",timer:1e3,toast:!0,showConfirmButton:!1,timerProgressBar:!0}),x.value="",O.push({path:"/"})},f=r([]),d=r(""),g=async()=>{var o,s;try{const n=await k.get(`${b}/todos/`,{headers:{Authorization:u.value}});d.value="",n.data.data.forEach(e=>{const h=e.createTime,P=new Date(h*1e3).toISOString().slice(0,19).replace("T"," ");e.createTime=P}),f.value=n.data.data}catch(n){L.value=((s=(o=n.response)==null?void 0:o.data)==null?void 0:s.message)||"geterror"}};g();const c=r(""),U=r({content:""}),I=async()=>{var o,s;if(!c.value||!c.value.trim())return y.fire({position:"top",title:"請輸入代辦事項",icon:"warning",timer:500,toast:!0,showConfirmButton:!1,timerProgressBar:!0});try{U.value.content=c.value;const n=await k.post(`${b}/todos/`,U.value,{headers:{Authorization:u.value}});c.value="",y.fire({position:"top",title:"新增成功",icon:"success",timer:500,toast:!0,showConfirmButton:!1,timerProgressBar:!0}),g()}catch(n){L.value=((s=(o=n.response)==null?void 0:o.data)==null?void 0:s.message)||"adderror"}},T=async o=>{var s,n;try{const e=await k.delete(`${gt}/todos/${o}`,{headers:{Authorization:u.value}});g()}catch(e){L.value=((n=(s=e.response)==null?void 0:s.data)==null?void 0:n.message)||"delerror"}},v=r("taball"),w=o=>{v.value=o},B=S(()=>f.value.filter(o=>o.status===!1)),z=S(()=>f.value.filter(o=>o.status===!0));return(o,s)=>{const n=W("RouterLink");return l(),a("div",M,[t("nav",null,[s[6]||(s[6]=t("h1",null,[t("a",{href:"#"},"ONLINE TODO LIST")],-1)),t("ul",null,[t("li",j,[t("a",q,[t("span",null,i(x.value.user.nickname)+"的代辦事項",1)]),R(n,{to:"/",onClick:E},{default:K(()=>s[5]||(s[5]=[G("登出")])),_:1})])])]),t("div",H,[t("div",X,[t("div",Y,[C(t("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":s[0]||(s[0]=e=>c.value=e)},null,512),[[D,c.value]]),t("a",{href:"",onClick:s[1]||(s[1]=p(e=>I(c.value),["prevent"]))},s[7]||(s[7]=[t("i",{class:"fa fa-plus"},null,-1)]))]),f.value.length!==0?(l(),a("div",J,[t("ul",Z,[t("li",null,[t("a",{href:"#",class:N({active:v.value==="taball"}),onClick:s[2]||(s[2]=p(e=>w("taball"),["prevent"]))},"全部",2)]),t("li",null,[t("a",{href:"#",class:N({active:v.value==="tabnot"}),onClick:s[3]||(s[3]=p(e=>w("tabnot"),["prevent"]))},"待完成",2)]),t("li",null,[t("a",{href:"#",class:N({active:v.value==="tabok"}),onClick:s[4]||(s[4]=p(e=>w("tabok"),["prevent"]))},"已完成",2)])]),v.value==="taball"?(l(),a("div",tt,[t("ul",et,[(l(!0),a(V,null,$(f.value,(e,h)=>(l(),a("li",{key:e.id},[t("label",{class:"todoList_label",for:e.id},[C(t("input",{class:"todoList_input",type:"checkbox",value:"true",id:e.id,"onUpdate:modelValue":_=>e.status=_},null,8,ot),[[A,e.status]]),t("span",null,i(e.content),1)],8,st),t("a",{href:"",onClick:p(_=>T(e.id),["prevent"])},s[8]||(s[8]=[t("i",{class:"fa fa-times"},null,-1)]),8,at)]))),128))]),t("p",null,i(d.value),1),d.value?m("",!0):(l(),a("div",lt,[t("p",null,i(B.value.length)+" 個待完成項目",1)]))])):m("",!0),v.value==="tabnot"?(l(),a("div",nt,[t("ul",it,[(l(!0),a(V,null,$(B.value,(e,h)=>(l(),a("li",{key:e.id},[t("label",{class:"todoList_label",for:e.id},[C(t("input",{class:"todoList_input",type:"checkbox",value:"true",id:e.id,"onUpdate:modelValue":_=>e.status=_},null,8,ut),[[A,e.status]]),t("span",null,i(e.content),1)],8,rt),t("a",{href:"",onClick:p(_=>T(e.id),["prevent"])},s[9]||(s[9]=[t("i",{class:"fa fa-times"},null,-1)]),8,dt)]))),128))]),t("p",null,i(d.value),1),d.value?m("",!0):(l(),a("div",ct,[t("p",null,i(B.value.length)+" 個待完成項目",1)]))])):m("",!0),v.value==="tabok"?(l(),a("div",vt,[t("ul",pt,[(l(!0),a(V,null,$(z.value,e=>(l(),a("li",{key:e.id},[t("label",{class:"todoList_label",for:e.id},[C(t("input",{class:"todoList_input",type:"checkbox",value:"true",id:e.id,"onUpdate:modelValue":h=>e.status=h},null,8,_t),[[A,e.status]]),t("span",null,i(e.content),1)],8,ht),t("a",{href:"",onClick:p(h=>T(e.id),["prevent"])},s[10]||(s[10]=[t("i",{class:"fa fa-times"},null,-1)]),8,mt)]))),128))]),t("p",null,i(d.value),1),d.value?m("",!0):(l(),a("div",ft,[t("p",null,i(z.value.length)+" 個已完成項目",1)]))])):m("",!0)])):(l(),a("div",kt,s[11]||(s[11]=[t("h2",null,"目前尚無待辦事項",-1),t("img",{src:"https://s3-alpha-sig.figma.com/img/7465/9ab1/8911ab6dcbda98df56e26aa23c6643ac?Expires=1725840000&Key-Pair-Id=APKAQ4GOSFWCVNEHN3O4&Signature=BmQcA76gk9l2y3s7vsRdmBkTjO8lYemchgz2fvvQqd6vEzKKoIKpTWxR5Iz6gkNQvICzQzSjfpXqRAiCmhCNaAQ6Nh7~7r0wEuxTCVOUzW8CGb7FlmUhs6GheqqJYxcxGV-lXtINwxY64LwHtFEXuKVwtdn2SiYuHNupWiTlTN77sAjR8vDZyjkSsuq4CXGVik3UGeHkJnsNAa-6eQ~QB-7HcW4F914N17QBifY47i8f~-AxsoBQ4OAmEM7uO-Jv1g1Wu7FEvy8-otCk79O2XZv6BpUsFTUyvDTR113J0ksi79QkwpeD8I6W4wZ1NxKwmvrxER6-COl7hStdVP1-QQ__",alt:"#"},null,-1)])))])])])}}};export{Lt as default};
