import{r,i as z,c as a,a as t,t as i,d as F,e as P,w as y,v as K,j as p,n as N,F as V,k as $,b as _,f as k,S as B,g as R,o as n,h as D,l as A}from"./index-CA9SyRrF.js";const G={id:"todoListPage",class:"bg-half"},M={class:"todo_sm"},W={href:"#"},j={class:"conatiner todoListPage vhContainer"},q={class:"todoList_Content"},H={class:"inputBox"},J={key:0,class:"todoList_list"},X={class:"todoList_tab"},Y={key:0,class:"todoList_items"},Z={class:"todoList_item"},tt=["for"],et=["id","onUpdate:modelValue"],st=["onClick"],ot={key:0,class:"todoList_statistics"},at={key:1,class:"todoList_items"},nt={class:"todoList_item"},lt=["for"],it=["id","onUpdate:modelValue"],ut=["onClick"],rt={key:0,class:"todoList_statistics"},dt={key:2,class:"todoList_items"},ct={class:"todoList_item"},vt=["for"],pt=["id","onUpdate:modelValue"],ht=["onClick"],_t={key:0,class:"todoList_statistics"},mt={key:1,style:{"text-align":"center"}},f="https://todolist-api.hexschool.io",Ct={__name:"List",setup(kt){const h=r(""),b=r(""),L=r({nickname:"",uid:""});(async()=>{h.value=document.cookie.replace(/(?:(?:^|.*;\s*)userToken\s*\=\s*([^;]*).*$)|^.*$/,"$1");const o=await k.get(`${f}/users/checkout`,{headers:{Authorization:h.value}});L.value=o.data,g()})();const O=r(""),S=async()=>{await k.post(`${f}/users/sign_out`,{},{headers:{Authorization:h.value}}),document.cookie="userToken=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/",O.value="已登出",B.fire({position:"top",title:`${O.value}`,icon:"success",timer:1e3,toast:!0,showConfirmButton:!1,timerProgressBar:!0}),L.value.uid=""},m=r([]),d=r(""),g=async()=>{var o,s;try{const l=await k.get(`${f}/todos/`,{headers:{Authorization:h.value}});d.value="",l.data.data.forEach(e=>{const C=e.createTime,I=new Date(C*1e3).toISOString().slice(0,19).replace("T"," ");e.createTime=I}),m.value=l.data.data}catch(l){b.value=((s=(o=l.response)==null?void 0:o.data)==null?void 0:s.message)||"geterror"}};g();const c=r(""),Q=r({content:""}),E=async()=>{var o,s;if(!c.value||!c.value.trim())return B.fire({position:"top",title:"請輸入代辦事項",icon:"warning",timer:500,toast:!0,showConfirmButton:!1,timerProgressBar:!0});try{Q.value.content=c.value;const l=await k.post(`${f}/todos/`,Q.value,{headers:{Authorization:h.value}});c.value="",B.fire({position:"top",title:"新增成功",icon:"success",timer:500,toast:!0,showConfirmButton:!1,timerProgressBar:!0}),g()}catch(l){b.value=((s=(o=l.response)==null?void 0:o.data)==null?void 0:s.message)||"adderror"}},x=async o=>{var s,l;try{const e=await k.delete(`${f}/todos/${o}`,{headers:{Authorization:h.value}});g()}catch(e){b.value=((l=(s=e.response)==null?void 0:s.data)==null?void 0:l.message)||"delerror"}},v=r("taball"),T=o=>{v.value=o},w=z(()=>m.value.filter(o=>o.status===!1)),U=z(()=>m.value.filter(o=>o.status===!0));return(o,s)=>{const l=R("RouterLink");return n(),a("div",G,[t("nav",null,[s[6]||(s[6]=t("h1",null,[t("a",{href:"#"},"ONLINE TODO LIST")],-1)),t("ul",null,[t("li",M,[t("a",W,[t("span",null,i(L.value.nickname)+"的代辦事項",1)]),F(l,{to:"/",onClick:S},{default:P(()=>s[5]||(s[5]=[D("登出")])),_:1})])])]),t("div",j,[t("div",q,[t("div",H,[y(t("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":s[0]||(s[0]=e=>c.value=e)},null,512),[[K,c.value]]),t("a",{href:"",onClick:s[1]||(s[1]=p(e=>E(c.value),["prevent"]))},s[7]||(s[7]=[t("i",{class:"fa fa-plus"},null,-1)]))]),m.value.length!==0?(n(),a("div",J,[t("ul",X,[t("li",null,[t("a",{href:"#",class:N({active:v.value==="taball"}),onClick:s[2]||(s[2]=p(e=>T("taball"),["prevent"]))},"全部",2)]),t("li",null,[t("a",{href:"#",class:N({active:v.value==="tabnot"}),onClick:s[3]||(s[3]=p(e=>T("tabnot"),["prevent"]))},"待完成",2)]),t("li",null,[t("a",{href:"#",class:N({active:v.value==="tabok"}),onClick:s[4]||(s[4]=p(e=>T("tabok"),["prevent"]))},"已完成",2)])]),v.value==="taball"?(n(),a("div",Y,[t("ul",Z,[(n(!0),a(V,null,$(m.value,(e,C)=>(n(),a("li",{key:e.id},[t("label",{class:"todoList_label",for:e.id},[y(t("input",{class:"todoList_input",type:"checkbox",value:"true",id:e.id,"onUpdate:modelValue":u=>e.status=u},null,8,et),[[A,e.status]]),t("span",null,i(e.content),1)],8,tt),t("a",{href:"",onClick:p(u=>x(e.id),["prevent"])},s[8]||(s[8]=[t("i",{class:"fa fa-times"},null,-1)]),8,st)]))),128))]),t("p",null,i(d.value),1),d.value?_("",!0):(n(),a("div",ot,[t("p",null,i(w.value.length)+" 個待完成項目",1)]))])):_("",!0),v.value==="tabnot"?(n(),a("div",at,[t("ul",nt,[(n(!0),a(V,null,$(w.value,(e,C)=>(n(),a("li",{key:e.id},[t("label",{class:"todoList_label",for:e.id},[y(t("input",{class:"todoList_input",type:"checkbox",value:"true",id:e.id,"onUpdate:modelValue":u=>e.status=u},null,8,it),[[A,e.status]]),t("span",null,i(e.content),1)],8,lt),t("a",{href:"",onClick:p(u=>x(e.id),["prevent"])},s[9]||(s[9]=[t("i",{class:"fa fa-times"},null,-1)]),8,ut)]))),128))]),t("p",null,i(d.value),1),d.value?_("",!0):(n(),a("div",rt,[t("p",null,i(w.value.length)+" 個待完成項目",1)]))])):_("",!0),v.value==="tabok"?(n(),a("div",dt,[t("ul",ct,[(n(!0),a(V,null,$(U.value,(e,C)=>(n(),a("li",{key:e.id},[t("label",{class:"todoList_label",for:e.id},[y(t("input",{class:"todoList_input",type:"checkbox",value:"true",id:e.id,"onUpdate:modelValue":u=>e.status=u},null,8,pt),[[A,e.status]]),t("span",null,i(e.content),1)],8,vt),t("a",{href:"",onClick:p(u=>x(e.id),["prevent"])},s[10]||(s[10]=[t("i",{class:"fa fa-times"},null,-1)]),8,ht)]))),128))]),t("p",null,i(d.value),1),d.value?_("",!0):(n(),a("div",_t,[t("p",null,i(U.value.length)+" 個已完成項目",1)]))])):_("",!0)])):(n(),a("div",mt,s[11]||(s[11]=[t("h2",null,"目前尚無待辦事項",-1),t("img",{src:"https://s3-alpha-sig.figma.com/img/7465/9ab1/8911ab6dcbda98df56e26aa23c6643ac?Expires=1725840000&Key-Pair-Id=APKAQ4GOSFWCVNEHN3O4&Signature=BmQcA76gk9l2y3s7vsRdmBkTjO8lYemchgz2fvvQqd6vEzKKoIKpTWxR5Iz6gkNQvICzQzSjfpXqRAiCmhCNaAQ6Nh7~7r0wEuxTCVOUzW8CGb7FlmUhs6GheqqJYxcxGV-lXtINwxY64LwHtFEXuKVwtdn2SiYuHNupWiTlTN77sAjR8vDZyjkSsuq4CXGVik3UGeHkJnsNAa-6eQ~QB-7HcW4F914N17QBifY47i8f~-AxsoBQ4OAmEM7uO-Jv1g1Wu7FEvy8-otCk79O2XZv6BpUsFTUyvDTR113J0ksi79QkwpeD8I6W4wZ1NxKwmvrxER6-COl7hStdVP1-QQ__",alt:"#"},null,-1)])))])])])}}};export{Ct as default};
