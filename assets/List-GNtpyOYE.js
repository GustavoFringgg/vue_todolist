import{r as u,u as D,j as S,k as I,c as a,a as t,t as i,e as R,f as E,w as L,v as j,n as _,p as P,F as U,q as z,d as m,b as q,S as y,g as k,h as G,o as n,i as K,s as N}from"./index-D65Yp2J1.js";const Q="/vue_todolist/assets/empty-BU8GQkiF.png",H={id:"todoListPage",class:"bg-half"},J={class:"todo_sm"},W={href:"/vue_todolist/#/todolist"},X={class:"conatiner todoListPage vhContainer"},Y={class:"todoList_Content"},Z={class:"inputBox"},tt={key:0,class:"todoList_list"},et={class:"todoList_tab"},ot={key:0,class:"todoList_items"},st={class:"todoList_item"},at=["for"],nt=["id","onUpdate:modelValue","onClick"],lt=["onClick"],it={key:0,class:"todoList_statistics"},rt={key:1,class:"todoList_items"},ut={class:"todoList_item"},dt=["for"],ct=["id","onUpdate:modelValue","onClick"],vt=["onClick"],pt={key:0,class:"todoList_statistics"},_t={key:2,class:"todoList_items"},ht={class:"todoList_item"},mt=["for"],kt=["id","onUpdate:modelValue","onClick"],ft=["onClick"],gt={key:0,class:"todoList_statistics"},Ct={key:1,style:{"text-align":"center"}},yt=["src"],f="http://localhost:3000",wt={__name:"List",setup(Lt){const r=u(""),b=u(""),$=D(),w=u("");(async()=>{r.value=document.cookie.replace(/(?:(?:^|.*;\s*)userToken\s*\=\s*([^;]*).*$)|^.*$/,"$1"),r.value||(y.fire({position:"top",title:"請登入",icon:"error",timer:1e3,toast:!0,showConfirmButton:!1,timerProgressBar:!0}),$.push({path:"/"}));try{const s=await k.get(`${f}/users/checkout`,{headers:{Authorization:r.value}});w.value=s.data,h()}catch(s){y.fire({position:"top",title:s.response.data.message,icon:"error",timer:500,toast:!0,showConfirmButton:!1,timerProgressBar:!0}),$.push({path:"/"})}})();const F=async()=>{const s=await k.post(`${f}/users/sign_out`,{headers:{Authorization:r.value}});console.log("signoutPost:",s),document.cookie="userToken=",y.fire({position:"top",title:`${s.data.message}`,icon:"success",timer:1e3,toast:!0,showConfirmButton:!1,timerProgressBar:!0}),w.value="",$.push({path:"/"})},g=u([]),d=u(""),h=async()=>{var s,e;try{const l=await k.get(`${f}/todos/`,{headers:{Authorization:r.value}});console.log("getTodo:",l),d.value="",g.value=l.data.message}catch(l){b.value=((e=(s=l.response)==null?void 0:s.data)==null?void 0:e.message)||"geterror"}};h();const c=u(""),A=u({todos:""}),O=async()=>{var s,e;if(!c.value||!c.value.trim())return y.fire({position:"top",title:"請輸入代辦事項",icon:"warning",timer:500,toast:!0,showConfirmButton:!1,timerProgressBar:!0});try{A.value.todos=c.value;const l=await k.post(`${f}/todos/`,A.value,{headers:{Authorization:r.value}});c.value="",y.fire({position:"top",title:"新增成功",icon:"success",timer:500,toast:!0,showConfirmButton:!1,timerProgressBar:!0}),h()}catch(l){b.value=((e=(s=l.response)==null?void 0:s.data)==null?void 0:e.message)||"adderror"}},x=async s=>{const e=await k.patch(`${f}/todos/${s}/toggle`,{},{headers:{Authorization:r.value}});console.log(e.data),h()},B=async s=>{var e,l;try{const o=await k.delete(`${f}/todos/${s}`,{headers:{Authorization:r.value}})}catch(o){b.value=((l=(e=o.response)==null?void 0:e.data)==null?void 0:l.message)||"delerror"}await h()},v=u("taball"),T=s=>{v.value=s},V=S(()=>g.value.filter(s=>s.status===!1)),M=S(()=>g.value.filter(s=>s.status===!0));return I(async()=>{await h()}),(s,e)=>{const l=G("RouterLink");return n(),a("div",H,[t("nav",null,[e[6]||(e[6]=t("h1",null,[t("a",{href:"#"},"ONLINE TODO LIST")],-1)),t("ul",null,[t("li",J,[t("a",W,[t("span",null,i(w.value.user.nickname)+"的代辦事項",1)]),R(l,{to:"/",onClick:F},{default:E(()=>e[5]||(e[5]=[K("登出")])),_:1})])])]),t("div",X,[t("div",Y,[t("div",Z,[L(t("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":e[0]||(e[0]=o=>c.value=o)},null,512),[[j,c.value]]),t("a",{href:"",onClick:e[1]||(e[1]=_(o=>O(c.value),["prevent"]))},e[7]||(e[7]=[t("i",{class:"fa fa-plus"},null,-1)]))]),g.value?(n(),a("div",tt,[t("ul",et,[t("li",null,[t("a",{href:"#",class:P({active:v.value==="taball"}),onClick:e[2]||(e[2]=_(o=>T("taball"),["prevent"]))},"全部",2)]),t("li",null,[t("a",{href:"#",class:P({active:v.value==="tabnot"}),onClick:e[3]||(e[3]=_(o=>T("tabnot"),["prevent"]))},"待完成",2)]),t("li",null,[t("a",{href:"#",class:P({active:v.value==="tabok"}),onClick:e[4]||(e[4]=_(o=>T("tabok"),["prevent"]))},"已完成",2)])]),v.value==="taball"?(n(),a("div",ot,[t("ul",st,[(n(!0),a(U,null,z(g.value,(o,C)=>(n(),a("li",{key:o._id},[t("label",{class:"todoList_label",for:o._id},[L(t("input",{class:"todoList_input",type:"checkbox",value:"true",id:o._id,"onUpdate:modelValue":p=>o.status=p,onClick:p=>x(o._id)},null,8,nt),[[N,o.status]]),t("span",null,i(o.todos),1)],8,at),t("a",{href:"",onClick:_(p=>B(o._id),["prevent"])},e[8]||(e[8]=[t("i",{class:"fa fa-times"},null,-1)]),8,lt)]))),128))]),t("p",null,i(d.value),1),d.value?m("",!0):(n(),a("div",it,[t("p",null,i(V.value.length)+" 個待完成項目",1)]))])):m("",!0),v.value==="tabnot"?(n(),a("div",rt,[t("ul",ut,[(n(!0),a(U,null,z(V.value,(o,C)=>(n(),a("li",{key:o.id},[t("label",{class:"todoList_label",for:o.id},[L(t("input",{class:"todoList_input",type:"checkbox",value:"true",id:o.id,"onUpdate:modelValue":p=>o.status=p,onClick:p=>x(o._id)},null,8,ct),[[N,o.status]]),t("span",null,i(o.todos),1)],8,dt),t("a",{href:"",onClick:_(p=>B(o._id),["prevent"])},e[9]||(e[9]=[t("i",{class:"fa fa-times"},null,-1)]),8,vt)]))),128))]),t("p",null,i(d.value),1),d.value?m("",!0):(n(),a("div",pt,[t("p",null,i(V.value.length)+" 個待完成項目",1)]))])):m("",!0),v.value==="tabok"?(n(),a("div",_t,[t("ul",ht,[(n(!0),a(U,null,z(M.value,o=>(n(),a("li",{key:o.id},[t("label",{class:"todoList_label",for:o.id},[L(t("input",{class:"todoList_input",type:"checkbox",value:"true",id:o.id,"onUpdate:modelValue":C=>o.status=C,onClick:C=>x(o._id)},null,8,kt),[[N,o.status]]),t("span",null,i(o.todos),1)],8,mt),t("a",{href:"",onClick:_(C=>B(o._id),["prevent"])},e[10]||(e[10]=[t("i",{class:"fa fa-times"},null,-1)]),8,ft)]))),128))]),t("p",null,i(d.value),1),d.value?m("",!0):(n(),a("div",gt,[t("p",null,i(M.value.length)+" 個已完成項目",1)]))])):m("",!0)])):(n(),a("div",Ct,[e[11]||(e[11]=t("h2",null,"目前尚無待辦事項",-1)),t("img",{src:q(Q),alt:"#"},null,8,yt)]))])])])}}};export{wt as default};
