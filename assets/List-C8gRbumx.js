import{r,u as S,j as A,k as D,c as a,a as t,t as i,e as I,f as R,w as b,v as E,n as p,p as V,F as P,q as U,d as _,b as j,S as g,g as y,h as q,o as l,i as G,s as N}from"./index-B21Zl-K_.js";const K="/vue_todolist/assets/empty-BU8GQkiF.png",Q={id:"todoListPage",class:"bg-half"},H={class:"todo_sm"},J={href:"/vue_todolist/#/todolist"},W={class:"conatiner todoListPage vhContainer"},X={class:"todoList_Content"},Y={class:"inputBox"},Z={key:0,class:"todoList_list"},tt={class:"todoList_tab"},et={key:0,class:"todoList_items"},st={class:"todoList_item"},ot=["for"],at=["id","onUpdate:modelValue"],lt=["onClick"],nt={key:0,class:"todoList_statistics"},it={key:1,class:"todoList_items"},rt={class:"todoList_item"},ut=["for"],dt=["id","onUpdate:modelValue"],ct=["onClick"],vt={key:0,class:"todoList_statistics"},pt={key:2,class:"todoList_items"},_t={class:"todoList_item"},ht=["for"],mt=["id","onUpdate:modelValue"],ft=["onClick"],kt={key:0,class:"todoList_statistics"},gt={key:1,style:{"text-align":"center"}},yt=["src"],L="http://localhost:3000",wt={__name:"List",setup(Lt){const u=r(""),C=r(""),w=S(),$=r("");(async()=>{u.value=document.cookie.replace(/(?:(?:^|.*;\s*)userToken\s*\=\s*([^;]*).*$)|^.*$/,"$1"),u.value||(g.fire({position:"top",title:"請登入",icon:"error",timer:1e3,toast:!0,showConfirmButton:!1,timerProgressBar:!0}),w.push({path:"/"}));try{const o=await y.get(`${L}/users/checkout`,{headers:{Authorization:u.value}});$.value=o.data,m()}catch(o){g.fire({position:"top",title:o.response.data.message,icon:"error",timer:500,toast:!0,showConfirmButton:!1,timerProgressBar:!0}),w.push({path:"/"})}})();const F=async()=>{const o=await y.post(`${L}/users/sign_out`,{headers:{Authorization:u.value}});console.log("signoutPost:",o),document.cookie="userToken=",g.fire({position:"top",title:`${o.data.message}`,icon:"success",timer:1e3,toast:!0,showConfirmButton:!1,timerProgressBar:!0}),$.value="",w.push({path:"/"})},h=r([]),d=r(""),m=async()=>{var o,e;try{const n=await y.get(`${L}/todos/`,{headers:{Authorization:u.value}});console.log("getTodo:",n),d.value="",h.value=n.data.message}catch(n){C.value=((e=(o=n.response)==null?void 0:o.data)==null?void 0:e.message)||"geterror"}};m();const c=r(""),z=r({todos:""}),O=async()=>{var o,e;if(!c.value||!c.value.trim())return g.fire({position:"top",title:"請輸入代辦事項",icon:"warning",timer:500,toast:!0,showConfirmButton:!1,timerProgressBar:!0});try{z.value.todos=c.value;const n=await y.post(`${L}/todos/`,z.value,{headers:{Authorization:u.value}});c.value="",g.fire({position:"top",title:"新增成功",icon:"success",timer:500,toast:!0,showConfirmButton:!1,timerProgressBar:!0}),m()}catch(n){C.value=((e=(o=n.response)==null?void 0:o.data)==null?void 0:e.message)||"adderror"}},B=async o=>{var e,n;try{const s=await y.delete(`${L}/todos/${o}`,{headers:{Authorization:u.value}});await m()}catch(s){C.value=((n=(e=s.response)==null?void 0:e.data)==null?void 0:n.message)||"delerror"}},v=r("taball"),T=o=>{v.value=o},x=A(()=>h.value.filter(o=>o.status===!1)),M=A(()=>h.value.filter(o=>o.status===!0));return D(async()=>{await m()}),(o,e)=>{const n=q("RouterLink");return l(),a("div",Q,[t("nav",null,[e[6]||(e[6]=t("h1",null,[t("a",{href:"#"},"ONLINE TODO LIST")],-1)),t("ul",null,[t("li",H,[t("a",J,[t("span",null,i($.value.user.nickname)+"的代辦事項",1)]),I(n,{to:"/",onClick:F},{default:R(()=>e[5]||(e[5]=[G("登出")])),_:1})])])]),t("div",W,[t("div",X,[t("div",Y,[b(t("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":e[0]||(e[0]=s=>c.value=s)},null,512),[[E,c.value]]),t("a",{href:"",onClick:e[1]||(e[1]=p(s=>O(c.value),["prevent"]))},e[7]||(e[7]=[t("i",{class:"fa fa-plus"},null,-1)]))]),h.value.length!==0?(l(),a("div",Z,[t("ul",tt,[t("li",null,[t("a",{href:"#",class:V({active:v.value==="taball"}),onClick:e[2]||(e[2]=p(s=>T("taball"),["prevent"]))},"全部",2)]),t("li",null,[t("a",{href:"#",class:V({active:v.value==="tabnot"}),onClick:e[3]||(e[3]=p(s=>T("tabnot"),["prevent"]))},"待完成",2)]),t("li",null,[t("a",{href:"#",class:V({active:v.value==="tabok"}),onClick:e[4]||(e[4]=p(s=>T("tabok"),["prevent"]))},"已完成",2)])]),v.value==="taball"?(l(),a("div",et,[t("ul",st,[(l(!0),a(P,null,U(h.value,(s,f)=>(l(),a("li",{key:f},[t("label",{class:"todoList_label",for:s._id},[b(t("input",{class:"todoList_input",type:"checkbox",value:"true",id:s._id,"onUpdate:modelValue":k=>s.status=k},null,8,at),[[N,s.status]]),t("span",null,i(s.todos),1)],8,ot),t("a",{href:"",onClick:p(k=>B(s._id),["prevent"])},e[8]||(e[8]=[t("i",{class:"fa fa-times"},null,-1)]),8,lt)]))),128))]),t("p",null,i(d.value),1),d.value?_("",!0):(l(),a("div",nt,[t("p",null,i(x.value.length)+" 個待完成項目",1)]))])):_("",!0),v.value==="tabnot"?(l(),a("div",it,[t("ul",rt,[(l(!0),a(P,null,U(x.value,(s,f)=>(l(),a("li",{key:s.id},[t("label",{class:"todoList_label",for:s.id},[b(t("input",{class:"todoList_input",type:"checkbox",value:"true",id:s.id,"onUpdate:modelValue":k=>s.status=k},null,8,dt),[[N,s.status]]),t("span",null,i(s.todos),1)],8,ut),t("a",{href:"",onClick:p(k=>B(s._id),["prevent"])},e[9]||(e[9]=[t("i",{class:"fa fa-times"},null,-1)]),8,ct)]))),128))]),t("p",null,i(d.value),1),d.value?_("",!0):(l(),a("div",vt,[t("p",null,i(x.value.length)+" 個待完成項目",1)]))])):_("",!0),v.value==="tabok"?(l(),a("div",pt,[t("ul",_t,[(l(!0),a(P,null,U(M.value,s=>(l(),a("li",{key:s.id},[t("label",{class:"todoList_label",for:s.id},[b(t("input",{class:"todoList_input",type:"checkbox",value:"true",id:s.id,"onUpdate:modelValue":f=>s.status=f},null,8,mt),[[N,s.status]]),t("span",null,i(s.todos),1)],8,ht),t("a",{href:"",onClick:p(f=>B(s._id),["prevent"])},e[10]||(e[10]=[t("i",{class:"fa fa-times"},null,-1)]),8,ft)]))),128))]),t("p",null,i(d.value),1),d.value?_("",!0):(l(),a("div",kt,[t("p",null,i(M.value.length)+" 個已完成項目",1)]))])):_("",!0)])):(l(),a("div",gt,[e[11]||(e[11]=t("h2",null,"目前尚無待辦事項",-1)),t("img",{src:j(K),alt:"#"},null,8,yt)]))])])])}}};export{wt as default};
