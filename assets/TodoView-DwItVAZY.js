import{r as u,u as D,j as S,k as I,c as a,a as t,t as r,e as R,f as E,w as L,v as j,n as _,p as U,F as P,q as z,d as m,b as q,S as y,g as k,s as G,h as J,o as n,i as K,x as N}from"./index-jUOCYpNl.js";const Q="/vue_todolist/assets/empty-BU8GQkiF.png",H={id:"todoListPage",class:"bg-half"},W={class:"todo_sm"},X={href:"/vue_todolist/#/todolist"},Y={class:"conatiner todoListPage vhContainer"},Z={class:"todoList_Content"},tt={class:"inputBox"},et={key:0,class:"todoList_list"},ot={class:"todoList_tab"},st={key:0,class:"todoList_items"},at={class:"todoList_item"},nt=["for"],lt=["id","onUpdate:modelValue","onClick"],it=["onClick"],rt={key:0,class:"todoList_statistics"},ut={key:1,class:"todoList_items"},dt={class:"todoList_item"},ct=["for"],vt=["id","onUpdate:modelValue","onClick"],pt=["onClick"],_t={key:0,class:"todoList_statistics"},ht={key:2,class:"todoList_items"},mt={class:"todoList_item"},kt=["for"],ft=["id","onUpdate:modelValue","onClick"],gt=["onClick"],Ct={key:0,class:"todoList_statistics"},yt={key:1,style:{"text-align":"center"}},$t=["src"],f="http://localhost:3000",Bt={__name:"TodoView",setup(Lt){const i=u(""),b=u(""),$=D(),w=u("");(async()=>{i.value=document.cookie.replace(/(?:(?:^|.*;\s*)userToken\s*\=\s*([^;]*).*$)|^.*$/,"$1"),i.value||(y.fire({position:"top",title:"請登入",icon:"error",timer:1e3,toast:!0,showConfirmButton:!1,timerProgressBar:!0}),$.push({path:"/"}));try{const s=await k.get(`${f}/users/checkout`,{headers:{Authorization:`Bearer ${i.value}`}});w.value=s.data,g()}catch(s){y.fire({position:"top",title:s.response.data.message,icon:"error",timer:500,toast:!0,showConfirmButton:!1,timerProgressBar:!0}),$.push({path:"/"}),setTimeout(()=>{G(()=>{location.reload()})},500)}})();const F=async()=>{const s=await k.post(`${f}/users/sign_out`,{headers:{Authorization:`Bearer ${i.value}`}});console.log("signoutPost:",s),document.cookie="userToken=; expires=Thu, 01 Jan 1970 00:00:00 UTC;",y.fire({position:"top",title:`${s.data.message}`,icon:"success",timer:1e3,toast:!0,showConfirmButton:!1,timerProgressBar:!0}),i.value="",w.value="",h.value=[],$.push({path:"/"})},h=u([]),d=u(""),g=async()=>{var s,e;try{const l=await k.get(`${f}/todos/`,{headers:{Authorization:`Bearer ${i.value}`}});console.log("getTodo:",l),d.value="",h.value=l.data.message}catch(l){b.value=((e=(s=l.response)==null?void 0:s.data)==null?void 0:e.message)||"geterror"}},c=u(""),A=u({todos:""}),O=async()=>{var s,e;if(!c.value||!c.value.trim())return y.fire({position:"top",title:"請輸入代辦事項",icon:"warning",timer:500,toast:!0,showConfirmButton:!1,timerProgressBar:!0});try{A.value.todos=c.value;const l=await k.post(`${f}/todos/`,A.value,{headers:{Authorization:`Bearer ${i.value}`}});c.value="",y.fire({position:"top",title:"新增成功",icon:"success",timer:500,toast:!0,showConfirmButton:!1,timerProgressBar:!0}),g()}catch(l){b.value=((e=(s=l.response)==null?void 0:s.data)==null?void 0:e.message)||"adderror"}},B=async s=>{const e=await k.patch(`${f}/todos/${s}/toggle`,{},{headers:{Authorization:`Bearer ${i.value}`}});console.log(e.data),g()},T=async s=>{var e,l;try{const o=await k.delete(`${f}/todos/${s}`,{headers:{Authorization:`Bearer ${i.value}`}})}catch(o){b.value=((l=(e=o.response)==null?void 0:e.data)==null?void 0:l.message)||"delerror"}await g()},v=u("taball"),x=s=>{v.value=s},V=S(()=>h.value.filter(s=>s.status===!1)),M=S(()=>h.value.filter(s=>s.status===!0));return I(async()=>{i.value?await g():$.push({path:"/"})}),(s,e)=>{const l=J("RouterLink");return n(),a("div",H,[t("nav",null,[e[6]||(e[6]=t("h1",null,[t("a",{href:"#"},"ONLINE TODO LIST")],-1)),t("ul",null,[t("li",W,[t("a",X,[t("span",null,r(w.value.user.nickname)+"的代辦事項",1)]),R(l,{to:"/",onClick:F},{default:E(()=>e[5]||(e[5]=[K("登出")])),_:1})])])]),t("div",Y,[t("div",Z,[t("div",tt,[L(t("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":e[0]||(e[0]=o=>c.value=o)},null,512),[[j,c.value]]),t("a",{href:"",onClick:e[1]||(e[1]=_(o=>O(c.value),["prevent"]))},e[7]||(e[7]=[t("i",{class:"fa fa-plus"},null,-1)]))]),h.value?(n(),a("div",et,[t("ul",ot,[t("li",null,[t("a",{href:"#",class:U({active:v.value==="taball"}),onClick:e[2]||(e[2]=_(o=>x("taball"),["prevent"]))},"全部",2)]),t("li",null,[t("a",{href:"#",class:U({active:v.value==="tabnot"}),onClick:e[3]||(e[3]=_(o=>x("tabnot"),["prevent"]))},"待完成",2)]),t("li",null,[t("a",{href:"#",class:U({active:v.value==="tabok"}),onClick:e[4]||(e[4]=_(o=>x("tabok"),["prevent"]))},"已完成",2)])]),v.value==="taball"?(n(),a("div",st,[t("ul",at,[(n(!0),a(P,null,z(h.value,(o,C)=>(n(),a("li",{key:o._id},[t("label",{class:"todoList_label",for:o._id},[L(t("input",{class:"todoList_input",type:"checkbox",value:"true",id:o._id,"onUpdate:modelValue":p=>o.status=p,onClick:p=>B(o._id)},null,8,lt),[[N,o.status]]),t("span",null,r(o.todos),1)],8,nt),t("a",{href:"",onClick:_(p=>T(o._id),["prevent"])},e[8]||(e[8]=[t("i",{class:"fa fa-times"},null,-1)]),8,it)]))),128))]),t("p",null,r(d.value),1),d.value?m("",!0):(n(),a("div",rt,[t("p",null,r(V.value.length)+" 個待完成項目",1)]))])):m("",!0),v.value==="tabnot"?(n(),a("div",ut,[t("ul",dt,[(n(!0),a(P,null,z(V.value,(o,C)=>(n(),a("li",{key:o.id},[t("label",{class:"todoList_label",for:o.id},[L(t("input",{class:"todoList_input",type:"checkbox",value:"true",id:o.id,"onUpdate:modelValue":p=>o.status=p,onClick:p=>B(o._id)},null,8,vt),[[N,o.status]]),t("span",null,r(o.todos),1)],8,ct),t("a",{href:"",onClick:_(p=>T(o._id),["prevent"])},e[9]||(e[9]=[t("i",{class:"fa fa-times"},null,-1)]),8,pt)]))),128))]),t("p",null,r(d.value),1),d.value?m("",!0):(n(),a("div",_t,[t("p",null,r(V.value.length)+" 個待完成項目",1)]))])):m("",!0),v.value==="tabok"?(n(),a("div",ht,[t("ul",mt,[(n(!0),a(P,null,z(M.value,o=>(n(),a("li",{key:o.id},[t("label",{class:"todoList_label",for:o.id},[L(t("input",{class:"todoList_input",type:"checkbox",value:"true",id:o.id,"onUpdate:modelValue":C=>o.status=C,onClick:C=>B(o._id)},null,8,ft),[[N,o.status]]),t("span",null,r(o.todos),1)],8,kt),t("a",{href:"",onClick:_(C=>T(o._id),["prevent"])},e[10]||(e[10]=[t("i",{class:"fa fa-times"},null,-1)]),8,gt)]))),128))]),t("p",null,r(d.value),1),d.value?m("",!0):(n(),a("div",Ct,[t("p",null,r(M.value.length)+" 個已完成項目",1)]))])):m("",!0)])):(n(),a("div",yt,[e[11]||(e[11]=t("h2",null,"目前尚無待辦事項",-1)),t("img",{src:q(Q),alt:"#"},null,8,$t)]))])])])}}};export{Bt as default};
